parameters:
  library: 'PySide'  # defaults for any parameters that aren't specified

steps:
  - script: |
      brew tap cartr/qt4
      brew tap-pin cartr/qt4
      brew install qt@4
      python -m pip install PySide==1.2.2
      pyside_postinstall.py -install
    condition: eq( variables['Agent.OS'], 'Darwin' )
    displayName: "Installing Qt wrapper on macOS"

  # xvfb starts on Linux but somehow the tests complain that
  # they can't connect to the X server.
  # - bash: |
  #     sudo apt-get install libqt4-dev
  #     python -m pip install PySide==1.2.2 --no-index --find-links https://parkin.github.io/python-wheelhouse
  #     pyside_postinstall.py -install
  #     export DISPLAY=:99.0
  #     sudo sh -e ./xvfb start
  #     sleep 3
  #     export QT_QPA_PLATFORM=offscreen
  #   condition: eq( variables['Agent.OS'], 'Linux' )
  #   displayName: "Installing Qt wrapper on Linux"

  - script: python -m pip install PySide==1.2.2
    condition: in( variables['Agent.OS'], 'Windows_NT' )
    displayName: "Installing Qt wrapper on Windows"
